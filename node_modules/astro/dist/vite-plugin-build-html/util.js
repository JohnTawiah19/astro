import { getAttribute, hasAttribute, getTagName } from "@web/parse5-utils";
import { isStylesheetLink } from "./extract-assets.js";
const tagsWithSrcSet = new Set(["img", "source"]);
function startsWithSrcRoot(pathname, srcRoot, srcRootWeb) {
  return pathname.startsWith(srcRoot) || pathname.startsWith(srcRootWeb) || `/${pathname}`.startsWith(srcRoot);
}
function isInSrcDirectory(node, attr, srcRoot, srcRootWeb) {
  const value = getAttribute(node, attr);
  return value ? startsWithSrcRoot(value, srcRoot, srcRootWeb) : false;
}
function isAstroInjectedLink(node) {
  return isStylesheetLink(node) && getAttribute(node, "data-astro-injected") === "";
}
function isBuildableLink(node, srcRoot, srcRootWeb) {
  if (isAstroInjectedLink(node)) {
    return true;
  }
  const href = getAttribute(node, "href");
  if (typeof href !== "string" || !href.length) {
    return false;
  }
  return startsWithSrcRoot(href, srcRoot, srcRootWeb);
}
function isBuildableImage(node, srcRoot, srcRootWeb) {
  if (getTagName(node) === "img") {
    const src = getAttribute(node, "src");
    return src ? startsWithSrcRoot(src, srcRoot, srcRootWeb) : false;
  }
  return false;
}
function hasSrcSet(node) {
  return tagsWithSrcSet.has(getTagName(node)) && !!getAttribute(node, "srcset");
}
function isHoistedScript(node) {
  return getTagName(node) === "script" && hasAttribute(node, "hoist");
}
export {
  hasSrcSet,
  isAstroInjectedLink,
  isBuildableImage,
  isBuildableLink,
  isHoistedScript,
  isInSrcDirectory
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc3JjL3ZpdGUtcGx1Z2luLWJ1aWxkLWh0bWwvdXRpbC50cyJdLAogICJtYXBwaW5ncyI6ICJBQUFBO0FBRUE7QUFFQSxNQUFNLGlCQUFpQixJQUFJLElBQUksQ0FBQyxPQUFPO0FBRXZDLDJCQUEyQixVQUFrQixTQUFpQixZQUE2QjtBQUMxRixTQUNDLFNBQVMsV0FBVyxZQUNwQixTQUFTLFdBQVcsZUFDcEIsSUFBSSxXQUFXLFdBQVc7QUFBQTtBQUlyQiwwQkFBMEIsTUFBc0IsTUFBYyxTQUFpQixZQUE2QjtBQUNsSCxRQUFNLFFBQVEsYUFBYSxNQUFNO0FBQ2pDLFNBQU8sUUFBUSxrQkFBa0IsT0FBTyxTQUFTLGNBQWM7QUFBQTtBQUd6RCw2QkFBNkIsTUFBK0I7QUFDbEUsU0FBTyxpQkFBaUIsU0FBUyxhQUFhLE1BQU0sMkJBQTJCO0FBQUE7QUFHekUseUJBQXlCLE1BQXNCLFNBQWlCLFlBQTZCO0FBQ25HLE1BQUksb0JBQW9CLE9BQU87QUFDOUIsV0FBTztBQUFBO0FBR1IsUUFBTSxPQUFPLGFBQWEsTUFBTTtBQUNoQyxNQUFJLE9BQU8sU0FBUyxZQUFZLENBQUMsS0FBSyxRQUFRO0FBQzdDLFdBQU87QUFBQTtBQUdSLFNBQU8sa0JBQWtCLE1BQU0sU0FBUztBQUFBO0FBR2xDLDBCQUEwQixNQUFzQixTQUFpQixZQUE2QjtBQUNwRyxNQUFJLFdBQVcsVUFBVSxPQUFPO0FBQy9CLFVBQU0sTUFBTSxhQUFhLE1BQU07QUFDL0IsV0FBTyxNQUFNLGtCQUFrQixLQUFLLFNBQVMsY0FBYztBQUFBO0FBRTVELFNBQU87QUFBQTtBQUdELG1CQUFtQixNQUErQjtBQUN4RCxTQUFPLGVBQWUsSUFBSSxXQUFXLFVBQVUsQ0FBQyxDQUFDLGFBQWEsTUFBTTtBQUFBO0FBRzlELHlCQUF5QixNQUErQjtBQUM5RCxTQUFPLFdBQVcsVUFBVSxZQUFZLGFBQWEsTUFBTTtBQUFBOyIsCiAgIm5hbWVzIjogW10KfQo=
