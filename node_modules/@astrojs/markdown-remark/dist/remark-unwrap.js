import { visit as _visit, SKIP } from "unist-util-visit";
const visit = _visit;
function remarkUnwrap() {
  const astroRootNodes = new Set();
  let insideAstroRoot = false;
  return (tree) => {
    insideAstroRoot = false;
    astroRootNodes.clear();
    visit(tree, "html", (node) => {
      if (node.value.indexOf("<astro-root") > -1 && !insideAstroRoot) {
        insideAstroRoot = true;
      }
      if (node.value.indexOf("</astro-root") > -1 && insideAstroRoot) {
        insideAstroRoot = false;
      }
      astroRootNodes.add(node);
    });
    visit(tree, "paragraph", (node, index, parent) => {
      if (parent && typeof index === "number" && containsAstroRootNode(node)) {
        parent.children.splice(index, 1, ...node.children);
        return [SKIP, index];
      }
    });
  };
  function containsAstroRootNode(node) {
    return node.children.map((child) => astroRootNodes.has(child)).reduce((all, v) => all ? all : v, false);
  }
}
export {
  remarkUnwrap as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3JjL3JlbWFyay11bndyYXAudHMiXSwKICAibWFwcGluZ3MiOiAiQUFBQTtBQUlBLE1BQU0sUUFBUTtBQUdDLHdCQUF3QjtBQUN0QyxRQUFNLGlCQUFpQixJQUFJO0FBQzNCLE1BQUksa0JBQWtCO0FBRXRCLFNBQU8sQ0FBQyxTQUFjO0FBRXJCLHNCQUFrQjtBQUNsQixtQkFBZTtBQUVmLFVBQU0sTUFBTSxRQUFRLENBQUMsU0FBUztBQUM3QixVQUFJLEtBQUssTUFBTSxRQUFRLGlCQUFpQixNQUFNLENBQUMsaUJBQWlCO0FBQy9ELDBCQUFrQjtBQUFBO0FBRW5CLFVBQUksS0FBSyxNQUFNLFFBQVEsa0JBQWtCLE1BQU0saUJBQWlCO0FBQy9ELDBCQUFrQjtBQUFBO0FBRW5CLHFCQUFlLElBQUk7QUFBQTtBQUdwQixVQUFNLE1BQU0sYUFBYSxDQUFDLE1BQU0sT0FBTyxXQUFXO0FBQ2pELFVBQUksVUFBVSxPQUFPLFVBQVUsWUFBWSxzQkFBc0IsT0FBTztBQUN2RSxlQUFPLFNBQVMsT0FBTyxPQUFPLEdBQUcsR0FBRyxLQUFLO0FBQ3pDLGVBQU8sQ0FBQyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBS2pCLGlDQUErQixNQUFXO0FBQ3pDLFdBQU8sS0FBSyxTQUFTLElBQUksQ0FBQyxVQUFlLGVBQWUsSUFBSSxRQUFRLE9BQU8sQ0FBQyxLQUFjLE1BQWdCLE1BQU0sTUFBTSxHQUFJO0FBQUE7QUFBQTsiLAogICJuYW1lcyI6IFtdCn0K
